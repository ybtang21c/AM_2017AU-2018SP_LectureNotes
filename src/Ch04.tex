\setcounter{chapter}{3}

\chapter{导数与不定积分}



\section{导数的计算}

\subsection{高阶导数}



\subsection{隐函数求导法则}



\section{微分}

\subsection{概念}

\section{变化率和相关变化率}




\section{不定积分}

\subsection{原函数与不定积分}

{\bf 定义4.5.1：}若在区间$I$上，$f\,'(x)=f(x)$，
则称$F(x)$是{\it $f(x)$在区间$I$上的原函数}。

{\bf 性质：}若$F(x)$是$f(x)$在区间$I$上的原函数，则
\begin{enumerate}
  \setlength{\itemindent}{1cm}
  \item $F(x)+C$也是$f(x)$在区间$I$上的原函数
  \item $f(x)$的任意两个原函数只相差一个常数
\end{enumerate}

{\bf 例：}不定积分表达式的多样形式
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\sin x\cos x\d x=\df12\sin^2x+C$
  \item $\dint\cos x\sin x\d x=\df12\cos^2x+C$
  \item $\dint\df12\sin2x\d x=\cos2x+C$
\end{enumerate}
以上三者都属于同一个函数族，仅相差一个常数！\ps{要想判断它们是否相同，
最可靠的方法还是求导，比较其导函数是否相同}

{\bf 例：}证明：函数$$f(x)=\left\{\begin{array}{ll}
0\;& x\ne 0\\1\;& x=0\end{array}\right.$$在$\mathbb{R}$上不存在原函数

证：反证法。设$F(x)$为$f(x)$的原函数。显然，当$x\ne0$时，$F(x)=x+C(C\in\mathbb{R})$，
注意到$F(x)$必须为连续函数，故易得$F(0)=C$。

由此，
$$f(0)=F'(0)=\limx{0}\df{F(x)-F(0)}x=\limx{0}\df xx=1,$$
与已知矛盾，故假设错误，即证。

{\bf 注：}{\b 具有第一类间断点的函数都不存在原函数}

{\bf 定理}（{\it 原函数的存在性}）
若函数$f(x)$在区间$I$上连续，则在$I$上存在原函数。

{\bf 定义4.5.2：}函数$f(x)$在区间$I$上的全体原函数称为{\it $f(x)$在$I$上的不定积分}，
记为
$$\int f(x)\d x$$

{\bf 注：}若$F(x)$是$f(x)$在区间$I$上的一个原函数， 则
$${\int f(x)\d x=F(x)+C},$$
其中$C$为任意常数。

{\bf 性质4.5.1：}{\b
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\left(\displaystyle\int f(x)\d x\right)'=f(x)$ 
  \item $\d\left[\displaystyle\int f(x)\d x\right]=f(x)\d x$ 
  \item $\dint f\,'(x)\d x =f(x)+C$
  \item $\dint \d f(x)=f(x)+C$
\end{enumerate}}

\subsection{基本不定积分公式}

{\it 求不定积分是求导的“逆运算”}{\b
\begin{enumerate} [(1)]
  \setlength{\itemindent}{1cm}
  \item $(C)'=0$\hfill  {$\dint 0\d x=C$} 
  \item $(x^a)'=ax^{a-1}$\hfill  {$\dint x^a\d x=\df{1}{a+1}x^{a+1}+C$}
  \item $(e^x)'=e^x$\hfill  {$\dint e^x\d x=e^x+C$} 
  \item $(a^x)'=a^x\ln a$\hfill  {$\dint a^x\d x=\df{a^x}{\ln a}+C$}
  \item $(\ln x)'=\df 1x$\hfill  {$\dint \df 1x\d x=\ln|x|+C$}
  \item $(\sin x)'=\cos x$\hfill  {$\dint \cos x\d x=\sin x+C$} 
  \item $(\cos x)'=\sin x$\hfill  {$\dint \sin x\d x=-\cos x+C$}
  \item $(\tan x)'=\sec^2 x$\hfill  {$\dint \sec^2 x\d x=\tan x+C$} 
  \item $(\cot x)'=-\csc^2 x$\hfill  {$\dint \csc^2 x\d x=-\cot x+C$}
  \item $(\sec x)'=\sec x\tan x$\hfill $\dint\sec x\tan x\d x=\sec x+C$
  \item $(\csc x)'=-\csc x\cot x$\hfill $\dint\csc x\cot x\d x=-\csc x+C$
  \item $(\arcsin x)'=\df{1}{\sqrt{1-x^2}}$ \hfill  
  {$\dint{\df{1}{\sqrt{1-x^2}}}\d x=\arcsin x+C$} 
  \item $(\arctan x)'=\df{1}{1+x^2}$ \hfill 
  {$\dint \df{1}{1+x^2}\d x=\arctan x+C$}
  \item $(\cosh x)'=\sinh x$ \hfill $\dint\sinh x\d x=\cosh x+C$
  \item $(\sinh x)'=\cosh x$ \hfill $\dint\cosh x\d x=\sinh x+C$
\end{enumerate}}

{\bf 注：}$x>0$时，$(\ln x)'=\df 1x$，所以$\dint\df{\d x}x=\ln x+C$，
$x<0$时，$(\ln(-x))'=\df1x$，所以$\dint\df{\d x}x=\ln(-x)+C$

{\bf 例3-4：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint x^2\sqrt{x}\d x$ 
  \item $\dint \df{1}{x\sqrt[3]{x}}\d x$ 
  \item $\dint \df{4^x}{9^x}\d x$ 
  \item $\dint 2^x3^{2x}5^{3x}\d x$
\end{enumerate}

\subsection{不定积分的运算法则}

{\bf 性质4.5.2}（线性运算）设函数$f(x),g(x)$的原函数存在，则
$$\int[\alpha f(x)+\beta g(x)]\d x=\alpha\int f(x)\d x+\beta\int g(x)\d x,$$
其中$\alpha,\beta$为任意常数。

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint (4x^3-2x^2+5x+3)\d x$
  \item $\dint(1-2x)^2\sqrt x\d x$
  \item $\dint\df{(x-\sqrt x)(1+\sqrt x)}{\sqrt[3]x}\d x$
  \item $\dint\df{\d x}{\sin^2x\cos^2x}$
  \item $\dint(10^x+3\sin x+\sqrt x)\d x$
  \item $\dint\sum\limits_{k=0}^na_kx^k$
\end{enumerate}

{\bf 例5-6：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint (x^2+1)^2\d x$ 
  \item $\dint\df{(x+1)^3}{x^2}\d x$ 
  \item $\dint\df{1-x^2}{x^2(1+x^2)}\d x$
  \item $\dint \df{x^4}{1+x^2}\d x$ 
  \item $\dint\df{1}{1+\cos 2x}\d x$ 
  \item $\dint\tan^2 x\d x$
\end{enumerate}

\section{不定积分的计算}

\subsection{换元法}

\subsubsection{【第一换元法】}

{\bf 定理6.3.1}（第一换元法）设$f(u)$具有原函数，$u=\varphi(x)$可导，则
$$\dint f[\varphi(x)]\varphi'(x)\d x=\left[\dint f(u)
\d u\right]_{u=\varphi(x)}$$

% {\bf 注：}设$F(x)$是$f(x)$的一个原函数，则
% $$\dint f[\varphi(x)]\varphi'(x)\d x=F[\varphi(x)]+C$$

{\bf 例：}计算下列不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\cos 2x\d x$ 
  \item $\dint\df 1{3+2x}\d x$
  \item $\dint\df{\d x}{x^2-a^2}$
  \item $\dint 2xe^{x^2}\d x$ 
  \item $\dint\df{x^2}{(x+2)^3}\d x\xlongequal{x+2=t}\ldots$ 
  \item $\dint\df 1{a^2+x^2}\d x=\df1a\dint\df1{1+(x/a)^2}\d\df xa=\ldots$ 
  \item $\dint\df 1{\sqrt{a^2-x^2}}\d x=\dint\df1{\sqrt{1-(x/a)^2}}\d\df
  xa=\ldots$
%   \hfill（令$t=\sqrt{a^2-x^2}$没有直接的效果，但可令$t=\sqrt{\df{a+x}{a-x}}$）
  \item $\dint \df 1{x(1+2\ln x)}\d x$ 
  \item $\dint\df {e^{3\sqrt x}}{\sqrt x}\d x=2\dint e^{\sqrt x}\d\sqrt x=\ldots$ 
  \item $\dint \sin^3x\d x=-\dint(1-\cos^2x)\d\cos x=\ldots$ 
  \item $\dint \sin^2x\cos^4x\d x=\df18\dint\sin^22x(1+\cos2x)\d x
  =\df18\dint\sin^22x\d x+\df1{16}\dint\sin^2x\d\sin^2x=\ldots$ 
  \item $\dint\sec^6x\d x=\dint(1+\tan^2 x)^2\d\tan x=\ldots$ 
  \item $\dint\sec x\d x=\dint\df{\cos x\d x}{1-\sin^2x}
  \xlongequal{t=\sin x}\dint\df{\d t}{1-t^2}=\ldots$
%   \hfill（$\dint\df{\sec x(\sec x+\tan x)}{(\sec x+\tan
%   x)}\d x=\ln|\sec x+\tan x|+C$）
\end{enumerate}

{\bf 注：}{\b 换元的基本原则：优先替换不好处理的部分，即{\it “看谁不顺眼就换谁”！}}

% {\bf 注：}另解
% $$\dint\sec x\d x=\dint\df{\sec x(\sec x+\tan x)}{(\sec x+\tan x)}\d x
% =\dint\df{\d(\sec x+\tan x)}{(\sec x+\tan x)}=
% \ln|\sec x+\tan x|+C$$

% \begin{shaded}
% {\bf 【第一换元法的一些常用技巧】}
% \begin{enumerate}
%   \setlength{\itemindent}{1cm}
%   \item {\bf 分项积分：}积化和差，有理分式分解，\ldots 
%   \item {\bf 降低幂次：}倍角公式，万能凑幂公式，\ldots 
%     $$\dint f(x^n)x^{n-1}\d x=\df 1n\dint f(x^n)\d x^n$$ 
%     $$\dint f(x^n)\df 1x\d x=\df 1n\dint f(x^n)\df{1}{x^n}\d x^n$$ 
%   \item {\bf 统一函数：}三角公式，$1=\sin^2x+\cos^2x$，\ldots 
%   \item {\bf 巧妙配元：}加一项减一项，\ldots
% \end{enumerate}
% \end{shaded}

\subsubsection{【第二换元法】}

{\bf 定理6.3.2}（第二换元法）设$x=\varphi(t)$可导且可逆，
$f[\varphi(t)]\varphi'(t)$具有原函数，则
$$\dint f(x)\d x=\left[\dint
f[\varphi(t)]\varphi'(t)\d t\right]_{t=\varphi^{-1}(x)}$$

{\bf 例：}计算下列不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint \sqrt{a^2-x^2}\d x\xlongequal{x=|a|\sin t}\dint a^2\cos^2t\d t
  =\df{a^2}2\dint(1+\cos2t)\d t=\ldots$ 
  \item $\dint\df{\d x}{\sqrt{x^2+a^2}}\xlongequal{x=|a|\tan t}
  \dint\sec t\d t=\ldots$
  \item $\dint\df{\d x}{(x^2+a^2)^2}\xlongequal{x=|a|\tan t}
  \df1{|a|^3}\dint\cos^3t\d t=\ldots$
  \item $\dint\df{\d x}{\sqrt{x^2-a^2}}\xlongequal{x=|a|\sec t}
  \dint\tan t\d t=\ldots$ 
  \item $\dint \df{1}{1+\sqrt x}\d x\xlongequal{\sqrt x=t}\ldots$ 
  \item $\dint\df{\d x}{1+\sqrt[3]{x+2}}\xlongequal{x+2=t^3}\ldots$ 
  \item $\dint\df{\sqrt{a^2-x^2}}{x^4}\d x\xlongequal{x=|a|\sin t}\ldots$
\end{enumerate}

\subsection{分部积分法}

注意到对可导函数$u,v$，有
$$\d uv=u\d v+v\d u\quad\Leftrightarrow\quad 
u\d v=\d uv-v\d u,$$
后一式两边同时不定积分，可得如下的{\it 分部积分公式}：
$${\b \dint u\d v=uv-\dint v\d u}$$

{\bf 例：}计算下列不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint x\cos x\d x$ 
  \item $\dint xe^x\d x$ 
  \item $\dint x^2e^x\d x$ 
  \item $\dint\ln x\d x$
  \item $\dint x\ln x\d x$ 
  \item $\dint x\arctan x\d x$ 
  \item $\dint e^x\sin x\d x$
  \item $\dint\csc^4x\d x$\\
  $$I=-\cot x\csc^2x+\dint\cot x\d(\csc^2x)=-\cot x\csc^2x-2I-2\cot x$$
  \item $\dint x\tan x\sec^2x\d x$
  $$I=\df12x\sec^2x-\df12\dint\sec^2\d x=\df12(x\sec^2x-\tan x)+C$$
  下面的解法错在哪里？令$x=\pi-t$\ps{求导验证结果不正确！}{\b
  \begin{align}
  I&=\dint\df{(\pi-t)\sin t}{\cos^3t}\d t=\pi\dint\df{\sin t}{\cos^3t}\d t
  -\dint\df{t\sin t}{\cos^3t}\d t\notag\\
  &=\pi\dint\d\left(\df1{2\cos^2t}\right)-I=\df{\pi}2\sec^2t-I\notag
  \end{align}
  故$I=\df{\pi}4\sec^2x+C$}
  \ps{$\dint\df{t\sin t}{\cos^3t}\d t\ne I$}
  \item $\dint\df{x\ln x}{(1+x^2)^2}\d x$
  \item $\dint\df{x\arctan x}{(1+x^2)^2}\d x$
\end{enumerate}

{\bf 注：}{\b {\it “{反对}不要碰，{三指}动一动”}——处理分部积分的一个大致原则，即：
按照{\it {“三指幂对反”}}的次序将被积函数中对应的部分放到微分符号后面}

\subsection{有理函数积分}

{\bf 有理函数（有理分式）：}$$f(x)=\df{P(x)}{Q(x)}$$
其中$P(x),Q(x)$均为多项式函数 ，若$P(x)$的次数小于$Q(x)$的次数，
称该函数为{\it 真分式} ，否则为{\it 假分式}

{\bf 注：}利用{\b\it 多项式除法}，任意假分式都可以表示成一个多项式与一个真分式的和，例如：
$$\df{2x^4+x^2+3}{x^2+1}=2x^2-1+\df{4}{x^2+1}$$

\begin{shaded}

\subsubsection{【有理函数分解的一般过程】}

第一步：任意多项式$Q(x)$在实数系内总能分解为一个常数，与形如$(x-a)^n$与$(x^2+px+q)^m$
的诸因式之乘积，其中$a$是$Q(x)$的$n$重根，二次多项式$x^2+px+q$没有实根（$p^2-4q<0$），
有共轭复根，且重数均为$m$，故
$${\b Q(x)=\prod\limits_{i=1}^s(x-a_i)^{\lambda_i}
\prod\limits_{j=1}^t(x^2+p_jx+q_j)^{\mu_j}},$$
其中$\lambda_1,\ldots,\lambda_s,\mu_1,\ldots,\mu_t$均为正整数，且
$$\lambda_1+\lambda_2+\ldots+\lambda_s+
\mu_1+\mu_2+\ldots+\mu_t=Q(x)\mbox{的次数}$$

第二步：根据代数的分项分式定理，真分式$\df{P(x)}{Q(x)}$可进行如下分解

{\b
\begin{align}
	\df{P(x)}{Q(x)}&=\df{A_1}{(x-a_1)^{\lambda_1}}
	+\df{A_2}{(x-a_1)^{\lambda_1-1}}+\ldots
	+\df{A_{\lambda_1}}{x-a_1}+\ldots\tag{*}\\
	&+\df{B_1}{(x-a_s)^{\lambda_s}}
	+\df{B_2}{(x-a_s)^{\lambda_s-1}}+\ldots
	+\df{B_{\lambda_s}}{x-a_s}+\ldots\notag\\
	&+\df{M_1x+N_1}{(x^2+p_1x+q_1)^{\mu_1}}
	+\df{M_2x+N_2}{(x^2+p_1x+q_1)^{\mu_1-1}}+\ldots
	+\df{M_{\mu_1}x+N_{\mu_1}}{x^2+p_1x+q_1}+\ldots\notag\\
	&+\df{U_1x+V_1}{(x^2+p_tx+q_t)^{\mu_t}}
	+\df{U_2x+V_2}{(x^2+p_tx+q_t)^{\mu_t-1}}+\ldots
	+\df{U_{\mu_t}x+V_{\mu_t}}{x^2+p_tx+q_t}\notag
\end{align}
}

第三步：用待定系数法求出以上的所有常数。
\end{shaded}

{\bf 例：}（基本的有理函数积分）\ps{\b 重点掌握！}

（1）{\b$\dint\df A{x-a}\d x=A\ln|x-a|+C$} 

（2）{\b$\dint\df{B\d x}{(x-a)^n}=\df B{(1-n)(x-a)^{n-1}}+C$}

（3）{\b$\dint\df{Q(x)}{(x-a)^n}$，令$u=x-a$}

例： $\dint\df x{(x+1)^3}\d x\xlongequal{u=x+1}\dint\df{(u-1)^3}{u^3}\d u$

（4）{\b$\dint\df{Cx+D}{x^2+px+q}\d x$，其中$p^2-4q<0$}

例：
\begin{align}
	\dint\df{x+1}{x^2+x+1}\d x
	&=\dint\df{\left(x+\df12\right)+\df12}{\left(x+\df12\right)^2+\df34}
	\d\left(x+\df12\right)\notag\\
	&=\df12\dint\df{\d\left(x+\df12\right)^2}
	{\left(x+\df12\right)^2+\df34}+\df{1}{\sqrt3}\dint
	\df{\d\df2{\sqrt3}\left(x+\df12\right)}
	{\left[\df2{\sqrt3}\left(x+\df12\right)\right]^2+1}\notag\\
	&=\df12\ln|x^2+x+1|+\df1{\sqrt3}\arctan\df2{\sqrt3}\left(x+\df12\right)+C\notag
\end{align}
一般地，
$$\dint\df{Cx+D}{x^2+px+q}\d x=
  \df C2\ln(x^2+px+q)+\df{2D-Cp}{\sqrt{4q-p^2}}
  \arctan\df{2x+p}{\sqrt{4q-p^2}}+C_1$$

（5）$\dint\df{Ex+F}{(x^2+px+q)^m}\d x$，其中$p^2-4q<0$

[提示]：参考（4）中示例的解法，（5）最终均可化为类似如下的积分

\begin{align}
	I_2&=\dint\df{\d x}{(1+x^2)^2}
	=\dint\df{(1+x^2)-x^2}{(1+x^2)^2}\d x
	=\dint\df{\d x}{1+x^2}-\df12\dint\df{x\d x^2}{(1+x^2)^2}\notag\\
	&=\dint\df{\d x}{1+x^2}+\df12\dint x\d\df1{1+x^2}\notag
	=\dint\df{\d x}{1+x^2}+\df12\df{x}{1+x^2}
	-\df12\dint\df{\d x}{1+x^2}\notag\\
	&=\df12\arctan x+\df{x}{2(1+x^2)}+C\notag
\end{align}

\begin{align}
	I_n&=\dint\df{\d x}{(1+x^2)^n}
	=\dint\df{(1+x^2)-x^2}{(1+x^2)^n}\d x
	=I_{n-1}-\df12\dint\df{x\d x^2}{(1+x^2)^n}\notag\\
	&=I_{n-1}+\df1{2(n-1)}\dint x\d\df1{(1+x^2)^{n-1}}\notag\\
	&=I_{n-1}+\df{x}{2(n-1)(1+x^2)^{n-1}}
	-\df1{2(n-1)}I_{n-1}\notag\\
	&=\df{2n-3}{2(n-1)}I_{n-1}+\df{x}{2(n-1)(1+x^2)^{n-1}}\notag
\end{align}

通过递推，最终可以得到

$$\dint\df{Ex+F}{(x^2+px+q)^m}\d x
  =\df E{2(1-m)(x^2+px+q)^{m-1}}+J_m$$

其中
$$J_m=\df{y}{2u^2(m-1)(y^2+u^2)^{m-1}}+
  \df{3-2m}{2u^2(1-m)}J_{m-1},$$
  $$J_1=\df1u\arctan\df yu+C$$

{\bf 注：}{\b 计算形如$\dint\df{\d x}{x^2+px+q}$的积分，
记$\Delta=p^2-4q$，

（i）若$\Delta>0$，则记$x_{1,2}=\df{-p\pm\sqrt{\Delta}}2$为$x^2+px+q=0$
的两个相异实根，于是
\begin{align}
	\dint\df{\d x}{x^2+px+q}&=\dint\df{\d x}{(x-x_1)(x-x_2)}
	=\df1{x_1-x_2}\dint\left(\df1{x-x_1}-\df1{x-x_2}\right)\d x\notag\\
	&=\df2{\sqrt{\Delta}}\ln\left|\df{x-x_1}{x-x_2}\right|+C\notag\\
	&=\df2{\sqrt{p^2-4q}}\ln\left|\df{2x+p-\sqrt{p^2-4q}}
	{2x+p+\sqrt{p^2-4q}}\right|+C\notag
\end{align}

（ii）若$\Delta=0$，则$x=-\df p2$为$x^2+px+q=0$的二重根，从而
$$\dint\df{\d x}{x^2+px+q}=\dint\df{\d x}{(x+p/2)^2}=-\df2{2x+p}+C$$

（iii）若$\Delta<0$，令$u=x+\df p2$，记$A=\sqrt{-\Delta/4}=\df{\sqrt{4q-p^2}}2$则
\begin{align}
	\dint\df{\d x}{x^2+px+q}&=\dint\df{\d u}{u^2+A^2}
	=\df1A\dint\df{\d(u/A)}{(u/A)^2+1}\notag\\
	&=\df1A\arctan\df uA+C=\df2{\sqrt{-\Delta}}
	\arctan\df{2x+p}{\sqrt{-\Delta}}+C\notag\\
	&=\df2{\sqrt{4q-p^2}}\arctan\df{2x+p}{\sqrt{4q-p^2}}+C\notag
\end{align}
}

{\bf 性质：}{\b 设$Q(x)$可分解为两个没有公因式的多项式$Q_1(x),Q_2(x)$的乘积，
则真分式$\df{P(x)}{Q(x)}$必可分解为
两个真分式$\df{P_1(x)}{Q_1(x)},\df{P_2(x)}{Q_2(x)}$的和}
\ps{这意味着并不总是需要分解成（*）式那样复杂精细的形式}

{\bf 例：}计算下列不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{x+1}{x^2+5x+6}\d x$ 
%   \item $\dint\df1{x^3}\d x$
  \item $\dint\df{x+2}{(2x+1)(x^2+x+1)}\d x$
  \item $\dint\df{x-3}{(x-1)(x^2-1)}\d x$
  \item $\dint\df{1-x^3}{(1+x)^4}\d x$
\end{enumerate}

\subsubsection{【一些可以化成有理函数的积分】}

{\bf 情形一：}
$${\b \dint R(\sin x,\cos x)\d x}$$
[提示]：{\b（万能代换）令$t=\tan\df x2$，则
$$\sin x=\df{2t}{1+t^2},\quad\cos x=\df{1-t^2}{1+t^2}$$}
从而
\begin{align}
	\mbox{原式}&=\dint\df{(1+t)^2}{4t}\d t
	=\df14\left(\ln|\tan\df x2|+2\tan\df x2+\df12\tan^2\df x2\right)+C\notag
\end{align}

{\bf 例：}$\dint\df{1+\sin x}{\sin x(1+\cos x)}\d x$

\bigskip

{\bf 情形二：}
{\b$$\dint R(\sin^2x,\cos^2x,\sin x,\cos x)\d x$$}

{\bf 例：}$\dint\df{\d x}{a^2\sin^2x+b^2\cos^2x},\;(ab\ne 0)$

[提示]：{\b 令$t=\tan x$}
\begin{align}
	\mbox{原式}&=\dint\df{\d t}{a^2t^2+b^2}=\df1{b}\arctan
	\df ab\tan x+C\notag
\end{align}

\bigskip

{\bf 情形三：}
$${\b\dint R\left(x,\sqrt[n]{\df{ax+b}{cx+d}}\right),(ad-bc\ne0)},$$

[提示]：令{\b$t=\sqrt[n]{\df{ax+b}{cx+d}}$，则
$$x=\df{d-bt^n}{at^n-c}\quad\Rightarrow\quad
\d x=\df{bc-ad}{(at^n-c)^n}\d t^n $$
}

{\bf 例：}$\dint\df1x\sqrt{\df{x+2}{x-2}}\d x$

[提示]：令$t=\sqrt{\df{x+2}{x-2}}$，则$t=\df{2(1+t^2)}{t^2-1}$，
\begin{align}
	\mbox{原式}&=-4\dint\df{t^2\d t}{1+t^2}=-4t+4\arctan t+C
	=-4\sqrt{\df{x+2}{x-2}}+4\arctan\sqrt{\df{x+2}{x-2}}+C\notag
\end{align}

{\bf 例：}$\dint\df{\d x}{(1+x)\sqrt{2+x-x^2}}$

[提示]： 令$t=\sqrt{\df{1+x}{2-x}}$，则$x=\df{2t^2-1}{1+t^2}$
$$\dint\df{\d x}{(1+x)\sqrt{2+x-x^2}}=\dint\df2{3t^2}\d t
=-\df23\sqrt{\df{2-x}{1+x}}+C$$

\bigskip

{\bf 情形四：}
{\b
$$\dint R(x,\sqrt{ax^2+bx+c})\d x,\;(a\ne0,b^2-4ac\ne0)$$
令$u=x+\df b{2a},k^2=\left|\df{4ac-b^2}{4a^2}\right|$，则$ax^2+bx+c$
必为如下三种情形之一
$$|a|(u^2+k^2),\quad |a|(u^2-k^2),\quad |a|(k^2-u^2),$$
从而上述无理根式的积分可化为下列三种形式之一
$$\dint R(u,\sqrt{u^2\pm k^2})\d u,\quad\dint R(u,\sqrt{k^2-u^2})\d u,$$
根据不同情况分别令$u=k\tan t,u=k\sec t,u=k\sin t$即可。
}

{\bf 例：}$\dint\df{\d x}{x\sqrt{x^2-2x-3}}$

[提示]：令$x-1=2\sec t$，则
\begin{align}
	\mbox{原式}&=\dint\df{\d t}{2+\cos t}
	\xlongequal{u=\tan\frac t2}2\dint\df{\d u}{u^2+3}
	=\df2{\sqrt3}\arctan\df u{\sqrt3}+C\notag\\
	&=\df2{\sqrt3}\arctan\left[\df1{\sqrt3}\tan
	\left(\arccos\df2{x-1}\right)\right]+C\notag
\end{align}

% $a\xlongequal[abc]{def}b$

[又解]：令$\sqrt{x^2-2x-3}=x-t$，\ps{若令$\sqrt{x^2-2x-3}=x+t$，会有类似的效果}
则
$$I=\df2{\sqrt3}\arctan
\df{\sqrt{x^2-2x-3}-x}{\sqrt3}+C$$

% {\bf 注：}
% $\arctan\df{\sqrt{x^2-2x-3}}{\sqrt3(x+1)}-\df{\pi}3=\arctan
% \df{\sqrt{x^2-2x-3}-x}{\sqrt3}$，

{\bf 例：}$\dint\df{\d x}{(x+1)\sqrt{1+2x-x^2}}$

[提示]：
\begin{align}
	\mbox{原式}&\xlongequal{x+1=\sqrt2\sin t}\dint\df{\d t}{\sqrt2\sin t}\notag
\end{align}

{\bf 例：}计算下列不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
%   \item $\dint\df{1+\sin x}{\sin x(1+\cos x)}\d x$ 
  \item $\dint\df{\sqrt{x-1}}{x}\d x$ 
  \item $\dint\df{\d x}{1+\sqrt[3]{x+2}}$ 
  \item $\dint\df{\d x}{(1+\sqrt[3]{x})\sqrt x}$ 
  \item $\dint\df 1x\sqrt{\df{1+x}{x}}\d x$
%   \item $\dint\df{x^2+\sin^2x}{x^2+1}\sec^2x\d x$
  \item $\dint\df 1{(x^2+1)\sqrt{1-x^2}}\d x$
  \item $\dint\df{3\cos x-4\sin x}{\cos x+2\sin x}\d x$
\end{enumerate}

% \begin{shaded}

\subsection{一些特殊的计算方法}

\subsubsection{【配对】}

{\bf 例：}$I=\dint\df{\sin x\d x}{2\sin x+3\cos x}$

{\bf 解：}
$$I_1=\dint\df{2\sin x+3\cos x}{2\sin x+3\cos x}\d x=x+C$$
$$I_2=\dint\df{(2\sin x+3\cos x)'}{2\sin x+3\cos x}
=\dint\df{2\cos x-3\sin x}{2\sin x+3\cos x}\d x=\ln|2\sin x+3\cos x|+C$$
从而
$$I=\df1{13}(2I_1-3I_2)$$

{\bf 例：}$M=\df{\d x}{1+x^4}$

{\bf 解：}$N=\dint\df{x^2\d x}{1+x^4}$
\begin{align}
M-N&=\dint\df{1-x^2}{1+x^4}\d x=-\dint\df{1-\df1{x^2}}{x^2+\df1{x^2}}\d
x\notag\\
&=-\dint\df{\d\left(x+\df1x\right)}{\left(x+\df1x\right)^2-2}
=-\df1{2\sqrt2}\ln\df{x^2-\sqrt2x+1}{x^2+\sqrt2x+1}+C\notag
\end{align}
$$M+N=\dint\df{\d\left(x-\df1x\right)}{\left(x-\df1x\right)^2+2}
=\df1{\sqrt2}\arctan\df{x^2-1}{\sqrt2x}+C$$

\subsubsection{【递推】}

{\bf 例：}$I_n=\dint\df{\d x}{(1+x^2)^n}$

{\bf 解：}
\begin{align}
I_n&=\dint\df{\d x}{(1+x^2)^n}=\df x{(1+x^2)^n}+2n\dint\df{x^2\d x}
{(1+x^2)^{n+1}}\notag\\
&=\df x{(1+x^2)^n}+2n\dint\left[\df1{(1+x^2)^n}-
\df1{(1+x^2)^{n+1}}\right]\d x\notag\\
&=\df x{(1+x^2)^n}+2nI_n-2nI_{n+1}\notag
\end{align}
故
$$I_{n+1}=\df1{2n}\df x{(1+x^2)^n}+\left(1-\df1{2n}\right)I_n$$

{\bf 例：}
$$I(m,n)=\dint\cos^mx\sin^nx\d x=
\df{\cos^{m-1}x\sin^{n+1}x}{m+n}+\df{m-1}{m+n}I(m-2,n)$$

\subsubsection{【倒代换】}

当被积函数的分母次数较高，特别是含有无理项时，可尝试令$x=\df 1t$

{\bf 例：}$\dint\df{\d x}{x^3\sqrt{1+x^2}}=-\dint\df{t^2\d t}{\sqrt{1+t^2}}
=-\df{\sqrt{1+x^2}}{2x^2}+\df12\ln\df{1+\sqrt{1+x^2}}{|x|}+C$

{\bf 例：}$\dint\df{\d x}{x^4\sqrt{1+x^2}}=-\dint\df{t^3\d t}{\sqrt{1+t^2}}
=-\df{\sqrt{(1+x^2)^3}}{3x^3}+\sqrt{1+x^2}x+C$

利用公式
$$\dint\df{P_n(x)}y\d x=Q_{n-1}y+\lambda\dint\df{\d x}y$$
（其中$y=\sqrt{qx^2+rx+s}$，$P_n(x),Q_{n-1}(x)$分别为$n$次和$n-1$次多项式）
可将倒代换应用于形如
$$\dint\df{\d x}{x^n\sqrt{ax^2+bx+c}}(n\geq1)$$
的不定积分。

{\bf 例：}$I=\dint\df{x^3\d x}{\sqrt{1+2x-x^2}}$

[提示]：令
$$I=(ax^2+bx+c)\sqrt{1+2x-x^2}+\lambda\dint\df{\d x}{\sqrt{1+2x-x^2}}$$
两边对$x$求导，可解得
$$a=-\df13,\quad b=-\df56,\quad,c=-\df{19}6,\quad\lambda=4$$

{\bf 例：}$I=\dint\df{\d x}{x^n\sqrt{ax^2+bx+c}},(n\geq 1)$

[提示]：令$x=\df 1t$，则
$$I=\dint\df{-t^{n-1}\d t}{\sqrt{a+bt+ct^2}}$$

形如
$$\dint\df{\sqrt{ax^2+bx+c}}{x^n}\d x$$
的积分

\subsubsection{【Euler代换】}

主要用于处理形如$\dint(R,\sqrt{ax^2+bx+c})$形式的积分，通过Eular代换可以将其化为
有理函数积分，具体代换形式如下：
\begin{enumerate}
  \setlength{\itemindent}{1cm}
  \item 当$a>0$时，令$\sqrt{ax^2+bx+c}\pm\sqrt ax=t$，
  即$x=\df{t^2-c}{b\pm2\sqrt at}$
  \item 当$c>0$时，令$\sqrt{ax^2+bx+c}\pm\sqrt c=tx$，
  即$x=\df{b\pm2\sqrt ct}{t^2-a}$
  \item 当$ax^2+bx+c=0$有两个实根$\alpha$和$\beta$时，
  令$\sqrt{ax^2+bx+c}=t(x-\alpha)$，
  即$x=\df{\alpha\beta-\alpha t^2}{a-t^2}$
\end{enumerate}

{\bf 例：}令$\sqrt{1+x^2}=t-x$，则
$$\dint\df{x^3}{\sqrt{1+x^2}}\d x=\dint\df{(t^2-1)^3}{8t^4}\d t$$

{\bf 例：}令$\sqrt{1+x^2}=xt-1$，则
$$\dint\df{x^3}{\sqrt{1+x^2}}\d x=-16\dint\df{t^3}{(t^2-1)^4}\d t$$

\subsubsection{【一题多解】}

{\bf 例：}$I=\dint\sec x\d x$

[解1]：
\begin{align}
	I&=\dint\df{\cos x}{1-\sin^2x}\d x
	\xlongequal{t=\sin x}\dint\df{\d u}{1-u^2}
	=\df12\dint\left(\df1{1+u}+\df1{1-u}\right)\d u\notag\\
	&=\df12\ln\df{1+\sin x}{1-\sin x}+C\notag
\end{align}

[解2]：
\begin{align}
	I&\xlongequal{t=\tan\frac x2}\dint2{1-t^2}\d t
	=\ln\left|\df{1+\tan x/2}{1-\tan x/2}\right|+C\notag
\end{align}

[解3]：
$$
I=\dint\df{\sec x(\sec x+\tan x)}{\sec x+\tan x}\d x
=\dint\df{\d(\sec x+\tan x)}{\sec x+\tan x}=\ln|\sec x+\tan x|+C
$$

{\bf 例：}$I=\dint\df{\d x}{x\sqrt{x^2-1}}$

[解1]：$t=\df1x$
$$I=\dint\df{\d x}{x^2\sqrt{1-1/x^2}}=-\dint\df{\d t}{\sqrt{1-t^2}}
=-\arcsin\df1x+C$$

[解2]：
$$I=\dint\df{x\d x}{x^2\sqrt{x^2-1}}=\dint\df{\d\sqrt{x^2-1}}
{(\sqrt{x^2-1})^2+1}=\arctan\sqrt{x^2-1}+C$$

[解3]：$x=\sec t$
$$I=\dint\df{\sec t\tan t}{\sec t\tan t}\d t=\arccos\df1x+C$$

[解4]：$\sqrt{x^2-1}=x-t$，则$x=(t^2+1)/(2t)$
$$\d x=\df{t^2-1}{2t^2}\d t,\quad \sqrt{x^2-1}=\df{1-t^2}{2t}$$
$$I=-2\dint{\d t}{1+t^2}=-2\arctan(x-\sqrt{x^2-1})+C$$

[解5]：$\sqrt{x^2-1}=t(x-1)$，从而$x=(t^2+1)/(t^2-1)$,
$$\d x=-\df{4t\d t}{(t^2-1)^2},\quad \sqrt{x^2-1}=\df{2t}{t^2-1}$$
$$I=-2\dint\df{\d t}{1+t^2}=-2\arctan\df{\sqrt{x^2-1}}{x-1}+C$$

{\it 解4-5都属于利用Eular变换解决型如$\dint R(x,\sqrt{ax^2+bx+c})\d x$的情形}

{\bf 例：}$I=\dint x^2\sqrt{x^2+1}\d x$

[解1]：$u=x^2$
\begin{align}
I&=\df12\dint\sqrt{u^2+u}\d u=\df12\dint\sqrt{\left(u+\df12\right)^2
-\left(\df12\right)^2}\d\left(u+\df12\right)\notag\\
&=\df18x(2x^2+1)\sqrt{x^2+1}-\df18\ln(x+\sqrt{x^2+1})+C\notag
\end{align}

[解2]：$\dint x\sqrt{x^2+1}\d x=\df13(x^2+1)^{\frac32}+C_1$
\begin{align}
I&=\df13\dint x\d(x^2+1)^{\frac32}=\df13 x(x^2+1)^{\frac32}
-\df13\dint(x^2+1)^{\frac32}\d x\notag\\
&=\df13x(x^2+1)^{\frac32}-\df13I-\df13\dint\sqrt{x^2+1}\d x\notag\\
&=\df13x(x^2+1)^{\frac32}-\df13I-\df16(x\sqrt{x^2+1}
+\ln(x+\sqrt{x^2+1}))\notag
\end{align}
故
$$I=\df14x(x^2+1)^{\frac32}-\df18(x\sqrt{x^2+1}
+\ln(x+\sqrt{x^2+1}))+C$$

[解3]：因为
$$(x^3\sqrt{x^2+1})'=3x^2\sqrt{x^2+1}+\df{x^4}{\sqrt{x^2+1}}
=4x^2\sqrt{x^2+1}-\sqrt{x^2+1}+\df1{\sqrt{x^2+1}},$$
故
$$x^2\sqrt{x^2+1}=\df14\left[(x^3\sqrt{x^2+1})'+\sqrt{x^2+1}
-\df1{\sqrt{x^2+1}}\right]$$
从而
$$I=\df14\left[x^3\sqrt{x^2+1}+\df x2\sqrt{x^2+1}
-\df12\ln(x+\sqrt{x^2+1})\right]+C$$

\section{小结}

求导有多容易，求不定积分就有多难。作为求导的逆运算，求不定积分是这学期
的有一个难点，除了要倒背如流地掌握求导公式，还必须熟悉和掌握一些常见
的求补丁积分方法和技巧。把洋葱一层层地剥开（{\it 链式法则}）容易，
把剥开的洋葱还原回去（{\it “凑微分”}）就不那么简单了。

\newpage

\section*{课后作业}
\addcontentsline{toc}{section}{课后作业}

{\bf 【必作题】}

\begin{itemize}
  \item 习题4.1：4(3)，11，12，14，15
  \item 习题4.2：6，9，13，14，15，16，17(2)，18，19(1,3)，20，21，27，28
  \ps{这一部分作业请对应讲课的进度来完成}
  \item 习题4.3：2，3(5-8)，4，8，11
  \item 习题4.4：8，10，12，15，17
  \item 习题4.5：1，4，6，7，8
\end{itemize}

\bigskip

\hrule

\bigskip
\bigskip

{\bf 【思考题】}

\begin{itemize}
  \item 习题4.1：9，13，16
  \item 证明过曲线$\sqrt x+\sqrt y=\sqrt a$上任一点$(x_0,y_0)$的切线在两坐标轴上
		的截距之和为常数。
  \item 习题4.2：12，22
  \item 求函数$y=\df{1}{x^2-3x-4}$的$n$阶导函数。
  \item 习题4.3：9，10，12，13，14
  \item 习题4.4：5，6，9，13，14，16
  \item 习题4.5：5，10，11，12，13
  \item 习题6.3：4，5，6\ps{强烈建议提前自学6.3节：积分的计算}
\end{itemize}

\newpage

\section*{不定积分计算的一些典型方法}

\begin{shaded}

{\bf 思路1：}通过代数恒等变换、三角恒等变换等方法，把所求的积分化为基本积分公式中
的积分或其他易于积分的形式。为此，需要熟练掌握基本的积分公式，这样才能有针对性地对
被积函数进行恒等变形。

\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df1{x^4(1+x^2)}\d x$
  \item $\dint(\tan x+\cot x)^2\d x$
  \item $\dint\df1{1+\sin x}\d x$
  \item $\dint\df1{\sin2x+2\sin x}\d x$
\end{enumerate}

[提示]:
(1) 方法1：
$$\mbox{原式}=\dint\df{(1+x^2)-x^2}{x^4(1+x^2)}\d x
=-\df1{3x^3}+\df1x+\arctan x+C$$

方法2：
$$\mbox{原式}=\dint\df{(1-x^4)+x^4}{x^4(1+x^2)}\d x$$

(2)
$$\tan x-\cot x+C$$

(3)方法1：
$$\mbox{原式}=\dint\df1{1+\cos\left(x-\df{\pi}2\right)}\d x=\ldots
=\tan\df{2x-\pi}4+C$$

方法2：
$$\mbox{原式}=\dint\df{1-\sin x}{\cos^2x}\d x=\ldots=\tan x-\sec x+C$$

(4)方法1：
$$\mbox{原式}=\df14\dint\df1{\sin\df x2\cos\df x2\cos^2\df x2}\d\df x2
=\df14\dint\df{1+\tan^2\df x2}{\tan\df x2}\d\tan\df x2
=\df14\ln\left|\tan\df x2\right|+\df18\tan^2\df x2+C$$

方法2：
$$\mbox{原式}=\dint\df{1-\cos x}{2\sin^3x}\d x=\ldots
=\df14\ln|\csc x-\cot x|-\df14\csc x\cot x+\df14\csc^2x+C$$

\begin{shaded}

{\bf 思路2：}对于不易观察出微分形式的不定积分，有时需要进行适当的恒等变形，
凑成$\dint f(\phi(x))\phi'(x)\d x=\dint f(\phi(x))\d\phi(x)$
的形式，利用凑微分法求出不定积分。

\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{2x+3}{\sqrt{1+2x-x^2}}\d x$
  \item $\dint\df1{1+e^x}\d x$
  \item $\dint\df1{x(x^n+a)}\d x,\;(a\ne 0,n\in\mathbb{Z}_+)$
  \item $\dint\df{x^2+1}{x^4+1}\d x$
\end{enumerate}

[提示]:
(1)方法1：
$$\mbox{原式}=\dint\df{5-(2-2x)}{\sqrt{1+2x-x^2}}\d x
=5\dint\df{\d(x-1)}{\sqrt{2-(x-1)^2}}-\dint\df{\d(1+2x-x^2)}
{\sqrt{1+2x-x^2}}$$
$$=5\arcsin\df{x-1}{\sqrt 2}-2\sqrt{1+2x-x^2}+C$$

方法2：令$x-1=\sqrt 2\sin t$

(2)方法1：
$$\mbox{原式}=\dint\df{1+e^x-e^x}{1+e^x}\d x=x-\ln(1+e^x)+C$$

方法2：
$$\mbox{原式}=\dint\df{e^x}{e^x(1+e^x)}\d x$$

方法3：
$$\mbox{原式}=\dint\df{e^{-x}}{1+e^{-x}}\d x$$

(3)方法1：
$$\mbox{原式}=\dint\df{x^{n-1}}{x^n(x^n+a)}\d x
=\ldots=\df1{na}\ln\left|\df{x^n}{x^n+a}\right|+C$$

方法2：
$$\mbox{原式}=\df1a\dint\df{a+x^n-x^n}{x(x^n+a)}\d x$$

(4)
$$\mbox{原式}=\dint\df{1+\df1{x^2}}{x^2+\df1{x^2}}\d x
=\df1{\sqrt2}\arctan\df{x^2-1}{\sqrt2x}+C$$

\begin{shaded}
{\bf 思路3：}对积分

1)\;$\dint\sin ax\cos bx\d x$\quad 2)$\dint\sin ax\sin bx\d x$\quad
3)$\dint\cos ax\cos bx\d x$

4)$\dint\sin^mx\cos^nx \d x$\quad 5)$\dint\tan^mx\sec^nx\d x$\quad
6)$\dint\cot^mx\csc^nx\d x$

主要通过三角变换来凑积分求解。
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item 1)-3)，和差化积；
  \item 4)，当$n$或$m$为奇数时，分离出一个$\cos x$（或$\sin x$），凑出
  $\d\sin x$（或$\d\cos x$），在利用$\sin^2x+\cos^2x=1$将剩余部分都化为
  $\cos x$或$\sin x$的多项式；若$m$和$n$均为偶数，利用倍角公式将函数降阶
  再积分即可；
  \item 5)，$m$为奇数时，分离出$\sec x\tan x$，可凑出$\d\sec x$，再将
  剩余部分都化为关于$\sec x$的多项式；当$n$为偶数时，分离出$\sec^2x$，可凑出
  $\d\tan x$，将剩余部分化为$\tan x$的多项式积分；
  \item 6)可参考5)的思路。
\end{enumerate}
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\cos3x\cos2x\d x=\df12\sin x+\df1{10}\sin5x+C$
  \item $\dint\sin^4x\cos^2x\d x=\df1{16}-\df1{64}\sin4x-\df1{48}\sin^32x+C$
  \item $\dint\sin^3x\cos^3x\d x=\df1{48}\cos^32x-\df1{16}\cos2x+C
  =\df14\sin^4x-\df16\sin^6x+C$
  \item $\dint\tan^3x\sec^4x\d x=\df14\tan^4x+\df16\tan^6x+C
  =\df16\sec^6x-\df14\sec^4x+C$
  \item $\dint\tan^3x\cos x\d x=\cos x+\df1{\cos x}+C$
  \item $\dint\cot^3x\csc^5x\d x=\df15\csc^5x-\df17\csc^7x+C$
\end{enumerate}

\begin{shaded}
{\bf 思路4：}被积函数含根式形式如$\sqrt{a^2\pm x^2}$，$\sqrt{x^2-a^2}$等，
常采用三角代换、倒代换等，但不要只拘泥于这种代换，应具体问题具体分析，如(5)用凑微分
法更好。

被积函数含$\sqrt{x^2-a^2}$型时，令$x=a\sec t$或者$x=a\csc t$，视$0<t<\df{\pi}2$。
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\ds\df2{x+\sqrt{1-x^2}}\d x$
  \item $\dint\ds\df1{x\sqrt{x^2-1}}\d x$
  \item $\dint\ds\df{\sqrt{1+x^2}}{x^2}\d x$
  \item $\dint\ds\df1{\sqrt{(9x^2-6x-1)^3}}\d x$
  \item $\dint\ds\df{1-x}{\sqrt{x(4-x)}}\d x$
\end{enumerate}

[提示]:
(1)$x=\sin t$,
$$\mbox{原式}=\arcsin x+\ln\left|x+\sqrt{1-x^2}\right|+C$$

(2)方法1：$x=\sec t$
$$\mbox{原式}=\arccos\df1x+C$$

方法2：$x>1$时，令$x=\df1t$；$x<-1$时，令$x=-\df1t$

方法3：$t=\sqrt{x^2-1}$，
$$\mbox{原式}=\arctan\sqrt{x^2-1}+C$$

方法4：
$$\mbox{原式}=\dint\df{1}{x^2}\d\sqrt{x^2-1}
=\dint\df1{1+(\sqrt{x^2-1})^2}\d\sqrt{x^2-1}$$

(3)$x=\tan t$
$$\mbox{原式}=\ln\left|x+\sqrt{1+x^2}\right|
-\df{\sqrt{1+x^2}}{x}+C$$

(4)$x=\df{\sqrt2}3\sec t+\df13$
$$\mbox{原式}=-\df16\df{3x-1}{\sqrt{9x^2-6x-1}}+C$$

(5)方法1：
$$\mbox{原式}=\df12\dint\df{4-2x-2}{\sqrt{x(4-x)}}\d x
=\dint\df{\d [x(4-x)]}{2\sqrt{x(4-x)}}-\dint\df{\d x}{\sqrt{x(4-x)}}
=\sqrt{x(4-x)}-2\arcsin\df{\sqrt x}2+C$$
$$\dint\df{\d x}{\sqrt{x(4-x)}}=\dint\df{\d x}{\sqrt{4-(x-2)^2}}
=\arcsin\df{x-2}2+C$$

\begin{shaded}
{\bf 思路5：}果断进行代换，将不易处理的部分代换成一个变量。
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{e^x(1+e^x)}{\sqrt{1-e^{2x}}}\d x$
  \item $\dint\df{\ln x}{x\sqrt{1+\ln x}}\d x$
\end{enumerate}

[提示]：(1)方法1：$e^x=\sin t$,
$$\mbox{原式}=\arcsin e^x-\sqrt{1-e^{2x}}+C$$

方法2：$\sqrt{1-e^{2x}}=t$

$$\mbox{原式}=\arccos\sqrt{1-e^{2x}}-\sqrt{1-e^{2x}}+C$$

方法3：
$$\mbox{原式}=\dint\df{e^x\d x}{\sqrt{1-e^{2x}}}
+\dint\df{e^{2x}\d x}{\sqrt{1-e^{2x}}}$$

(2)方法1：
$$\mbox{原式}=\dint\df{1+\ln x-1}{\sqrt{1+\ln x}}\d(\ln x)
=\df23(1+\ln x)^{\frac32}-2\sqrt{1+\ln x}+C$$

方法2：$\sqrt{1+\ln x}=t$

\begin{shaded}
{\bf 思路6：}被积函数为幂函数（或多项式函数）与指数函数、三角函数、对数函数或反三角函数
乘积的积分，可考虑分布积分法。
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint x^3e^{-x^2}\d x=-\df12(x^2+1)e^{-x^2}+C$
  \item $\dint (x+1)\sin^2x\d x=\df14x^2+\df12x-\df14(x+1)\sin 2x-
  \df18\cos2x+C$
  \item $\dint x\ln(1+x^2)\d x=\df12(1+x^2)\ln(1+x^2)-\df12x^2+C$
  \item $\dint\arctan\sqrt x\d x=(x+1)\arctan\sqrt x-\sqrt x+C$
  \item $\dint\ln\left(1+x+\sqrt{2x+x^2}\right)\d
  x=(x+1)\ln\left(1+x+\sqrt{2x+x^2}\right)-\sqrt{2x+x^2}+C$
  \item $\dint\df{\sin^2x}{e^x}\d x=\df{\cos2x-2\sin2x-5}{10}e^{-x}+C$
  \item $\dint e^{2x}(\tan x+1)^2\d x=e^{2x}\tan x+C$
  \item $\dint\df{xe^x}{(1+x)^2}\d x=\df{e^x}{x+1}+C$
  \item $\dint(1-2x^2)e^{-2x^2}\d x=xe^{-x^2}+C$
  \item $\dint\df{x+\sin x}{1+\cos x}\d x=x\tan\df x2+C$
  \item $\dint\df{1+\sin x}{1+\cos x}e^x\d x=e^x\tan\df x2+C$
  \item $\dint\df{e^{\arctan x}}{(1+x^2)^{3/2}}=\df{1+x}{2\sqrt{1+x^2}}
  e^{\arctan x}+C$
  \item $\dint\df{\ln x\d x}{(1+x^2)^{3/2}}=\df{x\ln x}{\sqrt{1+x^2}}
  -\ln\left(x+\sqrt{1+x^2}\right)+C$
\end{enumerate}

\begin{shaded}
{\bf 思路7：}利用有理函数分解计算有理函数积分
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{x^5}{1+x^3}\d x=\df13x^3-\df12\ln\left|1+x^3\right|+C$
  \item $\dint\df1{1+x^4}\d x=\df{\sqrt 2}8\ln\left|
  \df{x^2+\sqrt2x+1}{x^2-\sqrt2x+1}\right|+\df{\sqrt 2}4\arctan(\sqrt2x-1)
  +\df{\sqrt2}4\arctan(\sqrt2x+1)+C$
  \item $\dint\df{1-x^7}{x(1+x^7)}\d x=\ln|x|-\df27\ln\left|1+x^7\right|+C$
  \item $\dint\df{x^{11}\d x}{x^8-4x^4+3}=\df14x^4+\df18
  \ln\left|\df{(x^4-3)^9}{x^4-1}\right|+C$
\end{enumerate}

\begin{shaded}
{\bf 思路8：}三角函数的有理式积分，总可以使用万能公式化为有理函数来计算。但其后的计算
往往相当复杂，因此，结合三角函数的其他变化公式，进行适当变形寻求积分的途径，往往更加
简单些。
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{\cos x\d x}{1+\cos x}=x-\tan\df x2+C=x-\csc x+\cot x+C$
  \item $\dint\df1{2+\sin x}\d x=-\df2{\sqrt3}\arctan\df{2\cot\frac 
  x2+1}{\sqrt 3}+C$
  \item $\dint\df1{\sin x+\cos x}\d x=\df{\sqrt 2}{2}\ln\left|
  \df{\tan\df x2-1+\sqrt 2}{\tan\df x2-1-\sqrt 2}\right|+C
  =\df{\sqrt2}2\ln\left|\csc\left(x+\df{\pi}4\right)
  -\cot\left(x+\df{\pi}4\right)\right|+C$
  \item $\dint\df{\sin x\d x}{\sin x+\cos x}=\df12x=\df12
  \ln|\sin x+\cos x|+C$
  \item $\dint\df{\sin2x\d x}{\sin^2x+\cos x}=
  \ln|\cos^2x-\cos x-1|+\df1{\sqrt5}\ln\left|
  \df{2\cos x-1-\sqrt5}{2\cos x-1+\sqrt 5}\right|+C$
  \item $\dint\df{\cos^2x\d x}{1+\cos^2x}=x-\df1{\sqrt2}\arctan
  \df{\tan x}{\sqrt 2}+C$
\end{enumerate}

\begin{shaded}
{\bf 思路9：}含有$\ds\sqrt[n]{\df{ax+b}{cx+d}}$的无理函数积分，理论上用根式代换
可以求出其积分。但化为有理函数积分后，往往计算量较大，应优先考虑通过恒等变形凑微分来计算。
\end{shaded}

{\bf 例：}计算不定积分
\begin{enumerate}[(1)]
  \setlength{\itemindent}{1cm}
  \item $\dint\df{\sqrt[3]x}{x(\sqrt x-\sqrt[3]x)\d x}=6\ln\left|
  \df{\sqrt[6]x-1}{\sqrt[6]x}\right|+C$
  \item $\dint\df{\d x}{x\sqrt{1+\sqrt{x^3}}}=\df23\ln\left|
  \df{\sqrt{1+\sqrt{x^3}}-1}{\sqrt{1+\sqrt{x^3}}+1}\right|+C$
  \hfill$\sqrt{1+\sqrt{x^3}}=t$
  \item $\dint\sqrt{\df{x+1}{x-1}}\d x=\sqrt{x^2-1}+\ln\left|
  x+\sqrt{x^2-1}\right|+C$
  \item $\dint\df{\d x}{\sqrt(x-1)^3(x-2)}=2\sqrt{\df{x-2}{x-1}}+C$
  \item $\dint\df{xe^x\d x}{\sqrt{e^x+1}}=2(x-2)\sqrt{e^x+1}
  -4\ln{\sqrt{e^x+1}-1}+2x+C$
\end{enumerate}

[提示]:(3)$\sqrt{\df{x+1}{x-1}}=t$或直接分子有理化后凑微分

(4)$\sqrt{\df{x-2}{x-1}}=t$

(5)$\sqrt{e^x+1}=t$

% \newpage
% 
% % \Large\bf
% 
% {\bf 例：}$f(x)$以$2$为周期且处处可导，已知
% $$\lim\limits_{x\to 0}\df{f(1)-f(1-x)}{3x}=1,$$
% 则曲线$f(x)$在点$(3,f(3))$的切线斜率为\underline{\hspace{2cm}}
% 
% \bigskip
% 
% {\bf 例：}$f(x)=\lim\limits_{n\to\infty}\sqrt[n]{1+|x|^{3n}}$在
% $(-\infty,+\infty)$内(\underline{\hspace{2cm}})
% \begin{enumerate}[(A)]
%   \setlength{\itemindent}{1cm}
%   \item 处处可导；
%   \item 恰有一个不可导点；
%   \item 恰有两个不可导点；
%   \item 至少有三个不可导点。
% \end{enumerate}
% 
% \bigskip
% 
% {\bf 例：}$f(x)$在原点附近有定义，且满足$|f(x)|\leq x^2$，则$x=0$是
% $f(x)$的(\underline{\hspace{2cm}})
% \begin{enumerate}[(A)]
%   \setlength{\itemindent}{1cm}
%   \item 间断点；
%   \item 连续但不可导点；
%   \item 可导点且$f'(0)=0$；
%   \item 可导点但$f'(0)$的值不确定。
% \end{enumerate}
% 
% \bigskip
% 
% {\bf 例：}$f(x)$在$x=a$可导，且$f(a)\ne 0$，求
% $$\limn\left[\df{f\left(a+\df1n\right)}{f(a)}\right]^n$$
% 
% {\bf 例：}$f(x)$是以$5$为周期的连续函数，且在原点附近满足
% $$f(1+\sin x)-3f(1-\sin x)=8x+\circ(x),$$
% 已知$f(x)$在$x=1$可导，则$y=f(x)$在$x=6$处的切线斜率为\underline{\hspace{2cm}}
% 
% {\bf 例：}$f(x)$在$x=1$连续可导，$f'(1)=2$，则
% $\limx{0}\df1x\df{\d}{\d x}f(\cos^22x)=\underline{\hspace{2cm}}$
% 
% {\bf 例：}求$y^{(n)}$
% \begin{enumerate}[(1)]
%   \setlength{\itemindent}{1cm}
%   \item $y=\df{x+b}{x+a}$
%   \item $y=\df x{\sqrt{1+x}}$
% \end{enumerate}
% 
% {\bf 例：}$\left.\left(\sin\df x2+\cos2x\right)^{(99)}\right|_{x=\pi}=$
% (\underline{\hspace{2cm}})
% \begin{enumerate}[(A)]
%   \setlength{\itemindent}{1cm}
%   \item $0$；
%   \item $-\df1{2^{99}}$
%   \item $2^{99}-\df1{2^{99}}$
%   \item $2^{99}$
% \end{enumerate}
% 
% {\bf 例：}$f(x)=(x-a)^n\phi(x)$，$\phi(x)$在$x=a$附近有$n-1$阶连续导数，
% 求$f^{(n)}(a))$.

% \newpage
% 
% contest on blackboard
% 
% \begin{enumerate}[(1)]
%   \item $\left(\arctan^2x^2\right)'$
%   \item $\left(\sqrt{\df1{1-x}}\right)'$
%   \item $\left(\sin\tan\df1{x}\right)'$
%   \item $\left(\cot x^2+\sec\sqrt[3]x\right)'$
%   \item $\left(e^{-\frac1{x^2}}\right)'$
%   \item $\left(x^{\frac1x}\right)'$
%   \item $\left(e^x\sin e^x\right)'$
%   \item $\left(\sqrt{x+\sqrt x}\right)'$
%   \item $\left[e^x(x^2-1)\right]''$
%   \item $\left(\ln\df{1+x}{1-x}\right)'$
% \end{enumerate}

\newpage

{\bf 例：}证明：$\dint\df{\d x}{x^2\sqrt{ax+b}}=-\df{\sqrt{ax+b}}{bx}
-\df{a}{2b}\dint\df{\d x}{x\sqrt{ax+b}}$

证：
\begin{align*}
	\dint\df{\d x}{x^2\sqrt{ax+b}}&=\df2a\dint\df{\d\sqrt{ax+b}}{x^2}
	=2a\dint\df{\d\sqrt{ax+b}}{[(\sqrt{ax+b})^2-b]^2}\\
	&\xlongequal{t=\sqrt{ax+b}}2a\dint\df{\d t}{(t^2-b)^2}
	=\df{a}{2b}\dint\left(\df1{t+\sqrt b}-\df1{t-\sqrt b}\right)^2\d t\\
	&=\df{a}{2b}\left[\dint\df{\d t}{(t+\sqrt b)^2}
	-\dint\df{2\d t}{(t+\sqrt b)(t-\sqrt b)}
	+\dint\df{\d t}{(t-\sqrt b)^2}\right]\\
	&=\df{a}{2b}\left[-\df1{t+\sqrt b}-\df1{\sqrt b}
	\dint\left(\df1{t+\sqrt b}-\df1{t-\sqrt b}\right)\d t
	-\df1{t-\sqrt b}\right]\\
	&=-\df{at}{(t^2-b)b}-\df{a}{2b\sqrt b}
	\ln\left|\df{t+\sqrt b}{t-\sqrt b}\right|+C\\
	&=-\df{\sqrt{ax+b}}{bx}-\df{a}{2b\sqrt b}
	\ln\left|\df{\sqrt{ax+b}+\sqrt b}{\sqrt{ax+b}-\sqrt b}\right|+C
\end{align*}

类似的方法：
\begin{align*}
	\dint\df{\d x}{x\sqrt{ax+b}}&=\df2a\dint\df{\d\sqrt{ax+b}}{x}
	=2\dint\df{\d\sqrt{ax+b}}{(\sqrt{ax+b})^2-b}\\
	&\xlongequal{t=\sqrt{ax+b}}\dint\df{\d t}{t^2-b}
	=\df2{\sqrt b}\dint\left(\df1{t+\sqrt b}-\df1{t-\sqrt b}\right)\d t\\
	&=\df2{\sqrt b}\ln\left|\df{t+\sqrt b}{t-\sqrt b}\right|+C
	=\df2{\sqrt b}\ln\left|\df{\sqrt{ax+b}+\sqrt b}{\sqrt{ax+b}-\sqrt b}\right|+C
\end{align*}
代入等式验证即证。

{\bf 注：}以上的方法可以推广用于计算形如$\dint\df{\d x}{x^n\sqrt{ax+b}}$的
所有积分。下面是另一种解法：

\begin{center}
	\resizebox{!}{11cm}{\includegraphics{./images/ch4/intExWHN.jpg}}
\end{center}